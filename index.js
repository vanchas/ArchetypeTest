const questions = [
  {
     "archetypeId": 1,
     "question": "Я исхожу из того, что люди, с которыми я общаюсь, заслуживают доверия"
   },
   {
     "archetypeId": 2,
     "question": "Я не люблю быть в одиночестве"
   },
   {
     "archetypeId": 3,
     "question": "Соревнования заводят и активизируют меня"
   },
    {
     "archetypeId": 1,
     "question": "Я верю, что люди, в действительности, не хотят делать друг другу больно"
   },
   {
     "archetypeId": 2,
     "question": "Я знаю, что важно не ожидать слишком многого"
   },
   {
     "archetypeId": 3,
     "question": "Я готов рисковать собой, чтобы защищать свои принципы и права"
   },
   {
     "archetypeId": 1,
     "question": "Вокруг меня есть люди, на которых можно положиться, они смогут позаботятся обо мне"
   },
   {
     "archetypeId": 2,
     "question": "Дружба - это самое важное в жизни"
   },
   {
     "archetypeId": 3,
     "question": "В большинстве случаев я справляюсь со страхом и делаю то, что необходимо сделать"
   },
   {
     "archetypeId": 1,
     "question": "Я чувствую себя в безопасности"
   },
   {
     "archetypeId": 2,
     "question": "Важна не победа, а участие"
   },
   {
     "archetypeId": 3,
     "question": "Я всегда смогу противостоять обидчикам"
   },
   {
     "archetypeId": 1,
     "question": "Я знаю, что мои потребности будут удовлетворены, в итоге, я получу, что хочу"
   },
   {
     "archetypeId": 2,
     "question": "Меня раздражают хвастуны и выскочки"
   },
   {
     "archetypeId": 3,
     "question": "Меня устраивает, что я напористый и решительный"
   },
   {
     "archetypeId": 1,
     "question": "Мир – это безопасное место"
   },
   {
     "archetypeId": 2,
     "question": "Я не люблю выделяться из толпы"
   },
   {
     "archetypeId": 3,
     "question": "В условиях соревнования я проявляю все свои лучшие качества"
   },
   {
     "archetypeId": 4,
     "question": "Я нахожу смысл, полноту жизни в том, что помогаю другим людям"
   },
   {
     "archetypeId": 5,
     "question": "Я всегда ищу более комфортные условия"
   },
   {
     "archetypeId": 6,
     "question": "Я, в принципе, люблю всех людей"
   },
   {
     "archetypeId": 4,
     "question": "Мне кажется, что легче делать что-то для других, чем для себя"
   },
   {
     "archetypeId": 5,
     "question": "Я всегда ищу способы усовершенствовать себя"
   },
   {
     "archetypeId": 6,
     "question": "Я нахожу смысл жизни в отношениях"
   },
   {
     "archetypeId": 4,
     "question": "Мне нравится заботиться о других людях"
   },
   {
     "archetypeId": 5,
     "question": "Я чувствую себя тревожно"
   },
   {
     "archetypeId": 6,
     "question": "Мне нравится помогать людям встречаться и знакомиться друг с другом"
   },
   {
     "archetypeId": 4,
     "question": "Мне тяжело говорить нет"
   },
   {
     "archetypeId": 5,
     "question": "Я стараюсь до конца, чтобы получить что-то лучшее"
   },
   {
     "archetypeId": 6,
     "question": "Близкие, искренние отношения это самое главное для меня"
   },
   {
     "archetypeId": 4,
     "question": "Интересы других важнее моих собственных интересов"
   },
   {
     "archetypeId": 5,
     "question": "Я все время нахожусь в поисках новых возможностей"
   },
   {
     "archetypeId": 6,
     "question": "Я - романтик и мечтатель"
   },
   {
     "archetypeId": 4,
     "question": "Доброта для меня наивысшая ценность"
   },
   {
     "archetypeId": 5,
     "question": "Для меня очень важно сохранять личную свободу"
   },
   {
     "archetypeId": 6,
     "question": "Я чувствую себя более наполненным, когда я влюблен"
   },
   {
     "archetypeId": 7,
     "question": "Я всегда найду выход из неприятной ситуации"
   },
   {
     "archetypeId": 8,
     "question": "Я сам творец своей собственной жизни"
   },
   {
     "archetypeId": 9,
     "question": "У меня хорошо получается подбирать задачи, которые соответствуют способностям людей"
   },
   {
     "archetypeId": 7,
     "question": "Моя жизнь быстро меняется"
   },
   {
     "archetypeId": 8,
     "question": "У меня намного больше прекрасных идей, чем времени на их выполнение"
   },
   {
     "archetypeId": 9,
     "question": "У меня есть лидерские качества"
   },
   {
     "archetypeId": 7,
     "question": "В моей жизни присутствует какая-то пустота"
   },
   {
     "archetypeId": 8,
     "question": "Часто успех и большие достижения мне даются очень легко"
   },
   {
     "archetypeId": 9,
     "question": "Я люблю, чтобы все было под контролем"
   },
   {
     "archetypeId": 7,
     "question": "Правила существуют для того, чтобы их нарушать"
   },
   {
     "archetypeId": 8,
     "question": "Вдохновение легко приходит ко мне"
   },
   {
     "archetypeId": 9,
     "question": "Мне нравится брать на себя ответственность за что-либо"
   },
   {
     "archetypeId": 7,
     "question": "Недавний опыт заставил меня переосмыслить кто я есть"
   },
   {
     "archetypeId": 8,
     "question": "Люди считают меня творческим человеком"
   },
   {
     "archetypeId": 9,
     "question": "Я часто беру на себя лидерство в кризисных ситуациях, когда вещи уходят из под контроля"
   },
   {
     "archetypeId": 7,
     "question": "Я расстраиваюсь из-за неудач и проигрышей"
   },
   {
     "archetypeId": 8,
     "question": "У меня хорошее воображение"
   },
   {
     "archetypeId": 9,
     "question": "Мой долг – выполнять взятые на себя обязательства"
   },
   {
     "archetypeId": 10,
     "question": "Изменение моих мыслей приводит к изменениям в моей жизни"
   },
   {
     "archetypeId": 11,
     "question": "Я верю, что существует много позитивных способов смотреть на одну и ту же вещь/вопрос"
   },
   {
     "archetypeId": 12,
     "question": "Я люблю шутить и смешить людей"
   },
   {
     "archetypeId": 10,
     "question": "Я верю, что все и всё в этом мире взаимосвязаны"
   },
   {
     "archetypeId": 11,
     "question": "Я стремлюсь к объективности"
   },
   {
     "archetypeId": 12,
     "question": "Я подхожу с юмором к людям, которые слишком серьезные"
   },
   {
     "archetypeId": 10,
     "question": "Я люблю преобразовывать/ трансформировать ситуации"
   },
   {
     "archetypeId": 11,
     "question": "Меня часто посещают глубокие мысли"
   },
   {
     "archetypeId": 12,
     "question": "Меня считают прикольным, веселым"
   },
   {
     "archetypeId": 10,
     "question": "Часто мое присутствие - катализатор изменений вокруг"
   },
   {
     "archetypeId": 11,
     "question": "Я пытаюсь найти истину, которая скрывается за иллюзиями"
   },
   {
     "archetypeId": 12,
     "question": "Я посмеиваюсь над абсурдностью нашей жизни"
   },
   {
     "archetypeId": 10,
     "question": "Моя эффективность зависит от состояния моей души"
   },
   {
     "archetypeId": 11,
     "question": "Люди ждут от меня советов"
   },
   {
     "archetypeId": 12,
     "question": "Я предпочитаю жить сегодняшним днем"
   },
   {
     "archetypeId": 10,
     "question": "Процесс моего собственного умиротворения помогает мне помочь другим"
   },
   {
     "archetypeId": 11,
     "question": "Я люблю вызовы, сложные задачи, которые заставляют меня думать"
   },
   {
     "archetypeId": 12,
     "question": "Нет ничего лучше, чем посмеяться от души"
   }
 ];
const answers = [
   {
     'weight': 1,
     'answer': "Полностью не согласен"
   },
   {
     'weight': 2,
     'answer': "Не согласен"
   },
   {
     'weight': 3,
     'answer': "Не уверен"
   },
   {
     'weight': 4,
     'answer': "Согласен"
   },
   {
     'weight': 5,
     'answer': "Полностью согласен"
   }
 ];
const archetypes = [
   {
       counting: [],
       "id": 1,
       "name": "Невинный",
       "shortDescription": "Полезный, благотворный, чистый, честный, всепрощающий, достойный доверия, счастливый, оптимистичный, любит простые удовольствия"
   },
   {
       counting: [],
       "id": 2,
       "name": "Славный малый",
       "shortDescription": "Неброский, прямолинейный, как все, надежный, практичный, приземленный, предсказуемый, статус кво, традиционный"
   },
   {
       counting: [],
       "id": 3,
       "name": "Герой",
       "shortDescription": "Воитель, соревнующийся, агрессивный, победитель, принципиальный, идеалист, отрицает все плохое, стремится улучшить мир, гордый, смелый, отважный"
   },
   {
   counting: [],
     "id": 4,
     "name": "Родитель",
     "shortDescription": "Альтруистический, не думающий о себе, заботливый, сострадательный, сопереживающий, готовы помочь, щедрый, благородный"
   },
   {
   counting: [],
     "id": 5,
     "name": "Искатель",
     "shortDescription": "Исследователь, рискованный, опасный, независимый, самоустремленный, самореализующийся, ценящий свободу"
   },
   {
   counting: [],
     "id": 6,
     "name": "Любовник",
     "shortDescription": "В поисках настоящей любви, интимный, чувствительный, страстный, сексуальный, соблазнительный, ищет наслаждения, баловень, живет эмоциями"
   },
   {
   counting: [],
     "id": 7,
     "name": "Бунтарь",
     "shortDescription": "Мятежный, шокирующий, пробивной, разрушительный, cильный, влиятельный, революционный, освободительны"
   },
   {
   counting: [],
     "id": 8,
     "name": "Творец",
     "shortDescription": "Новатор, фантазер, артистичный, экспериментатор, идет на риск, амбициозный"
   },
   {
   counting: [],
     "id": 9,
     "name": "Правитель",
     "shortDescription": "Управленец, организатор, Квалифицированный, действительный, эффективный, продуктивный, уверенный, ответственный, ролевая модель"
   },
   {
   counting: [],
     "id": 10,
     "name": "Волшебник",
     "shortDescription": "Шаман, целитель, божественный, интуитивный, волшебные моменты и ритуалы, катализатор для изменений, харизма и обаяние"
   },
   {
   counting: [],
     "id": 11,
     "name": "Мудрец",
     "shortDescription": "Мыслитель, философ, задумчивый, эксперт, советник, учитель, самоуверенный, самоконтролируемый, независимый"
   },
   {
   counting: [],
     "id": 12,
     "name": "Шут",
     "shortDescription": "Шутник, клоун, фокусник, игривый, веселый, принимает вещи легко, создает веселье/хаос, импульсивный, спонтанный, живет одним моментом."
   }
 ];
 
function renderForm() {
 let form = document.createElement('form');
 form.className = 'wrapper';
 document.body.append(form);
 form.setAttribute('method', 'post');
 form.setAttribute('onsubmit', 'FA(sortByCount, renderResult);return false;');
 form.setAttribute('name', 'set_from');
}
renderForm();
 
 let attributeDataId;
 
 function renderFormInner(questions) {
   let form = document.querySelector('.wrapper');
   
   let fieldset = document.createElement('fieldset');
   form.append(fieldset);
   fieldset.className = 'container';
 
   let legend = document.createElement('legend');
   fieldset.append(legend);
   legend.className = 'question';
   legend.textContent = questions.question;
   fieldset.setAttribute('data-id', questions.archetypeId);
   attributeDataId = fieldset.getAttribute('data-id');
   
   function renderInputAndLabel(answerItem,answerIndex) {
     let label = document.createElement('label');
     fieldset.append(label);
     label.className = 'label';
     label.textContent = answers[answerIndex].answer;
     
     let input = document.createElement('input');
     label.prepend(input);
     input.className = 'input';
     input.setAttribute('type', 'radio');
     input.setAttribute('value', answerIndex + 1);
     input.setAttribute('data-id', attributeDataId);
   }
   answers.forEach((answerItem,answerIndex) => {
     renderInputAndLabel(answerItem,answerIndex);
   });
 }
 
 questions.forEach((question) => {
   renderFormInner(question);  
 });
 
 let questionsCollection = document.querySelectorAll('.container');
 questionsCollection.forEach((collectionItem,collectionIndex) => {
   let inputs = collectionItem.querySelectorAll('.input');
   inputs.forEach((input, index) => {
     inputs[index].setAttribute('name', collectionIndex);
   });
   collectionItem.lastChild.querySelector('.input').setAttribute('required', 'required');
 });

function renderSubmit() {
  let form = document.querySelector('.wrapper');
  
  let submit = document.createElement('input');
  submit.setAttribute('type', 'submit');
  submit.setAttribute('value', 'Узнать результат');
  submit.className = 'btn-submit';
  form.append(submit);
}
 renderSubmit();
 
 function FA(sortByCount, renderResult) {
   let radio = document.getElementsByClassName('input');
     for (let radioItem = 0; radioItem < radio.length; radioItem++) {
       for (let archetype = 0; archetype < archetypes.length; archetype++) {
          if (radio[radioItem].checked && 
              radio[radioItem].getAttribute('data-id') == archetypes[archetype].id) {
            archetypes[archetype].counting.push(radio[radioItem].value);
            archetypes[archetype].counting.reduce((sum, current) => sum + parseInt(current), 0);
          }
       }
     }
   sortByCount(archetypes);
   renderResult();
   let form = document.querySelector('.wrapper');
   form.remove();
   document.querySelector('.progress-container').remove();
   document.querySelector('.head').textContent = "";
   document.querySelector('.head').textContent = "Ваш результат";
   window.scrollTo(0,0);
   let display = document.querySelector('.display');
   archetypes.forEach((item, index) => {
     display.insertAdjacentHTML('beforeend', `${archetypes[index].name} <br/> ${archetypes[index].shortDescription} <hr/>`);
   });
 }
 
 function sortByCount(arr) {
   arr.sort((a, b) => a.counting > b.counting ? -1 : 1);
 }
 
function renderResult() {
   let display = document.createElement('div');
   display.className = "display";
   document.body.append(display);
}
 
 //scroll-line
 window.onscroll = function() {
  scrollFunction()
};

function scrollFunction() {
  let winHiddenScroll = document.body.scrollTop || document.documentElement.scrollTop;
  let height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
  let scrolled = (winHiddenScroll / height) * 100;
  document.querySelector('.progress-bar').style.width = scrolled + "%";
  document.querySelector('.progress-bar').innerHTML = `<span>...</span>` + Math.round(scrolled) + "%";
}